# Claude Work Handoff

## Original Plan
Migrate all SWR usage to TanStack Query across 74 files in apps/web.

## Clarified Requirements
- Target: TanStack Query (already in use for user/workspace queries)
- Scope: All 74 files at once
- Goal: Remove SWR dependency entirely, standardize on TanStack Query

## Files to Migrate (74 total)

### Critical Path (migrate first)
1. `apps/web/core/lib/wrappers/authentication-wrapper.tsx`
2. `apps/web/core/lib/wrappers/instance-wrapper.tsx`
3. `apps/web/core/layouts/auth-layout/workspace-wrapper.tsx`
4. `apps/web/core/layouts/auth-layout/project-wrapper.tsx`
5. `apps/web/app/provider.tsx`

### Hooks
6. `apps/web/core/hooks/use-timezone.tsx`
7. `apps/web/core/hooks/use-workspace-issue-properties.ts`
8. `apps/web/core/components/sprints/active-sprint/use-sprints-details.ts`

### Pages/Routes (15 files)
- onboarding, notifications, invitations, webhooks, api-tokens, integrations, views, pages, archives, profile

### Components by Domain (55+ files)
- workspace, stickies, sprints, project, profile, pages, issues, integration, inbox, home, estimates, exporter, core, analytics, api-token, account

## Migration Pattern

### SWR to TanStack Query Mapping

| SWR | TanStack Query |
|-----|----------------|
| `useSWR(key, fetcher)` | `useQuery({ queryKey: [key], queryFn: fetcher })` |
| `data` | `data` |
| `error` | `error` |
| `isLoading` | `isPending` (no data yet) or `isLoading` (fetching) |
| `isValidating` | `isFetching` |
| `mutate()` | `queryClient.invalidateQueries()` |
| `useSWRMutation` | `useMutation` |

### Example Migration

**Before (SWR):**
```typescript
import useSWR from "swr";

const { data, error, isLoading, mutate } = useSWR(
  workspaceSlug ? `WORKSPACE_${workspaceSlug}` : null,
  workspaceSlug ? () => workspaceService.getWorkspace(workspaceSlug) : null,
  { revalidateOnFocus: false }
);
```

**After (TanStack Query):**
```typescript
import { useQuery, useQueryClient } from "@tanstack/react-query";

const queryClient = useQueryClient();
const { data, error, isPending } = useQuery({
  queryKey: ["workspace", workspaceSlug],
  queryFn: () => workspaceService.getWorkspace(workspaceSlug),
  enabled: !!workspaceSlug,
  staleTime: 5 * 60 * 1000,
});
```

## Existing TanStack Query Patterns to Follow
- See `apps/web/core/store/queries/` for existing query patterns
- Query keys defined in `apps/web/core/store/queries/query-keys.ts`
- Follow the same staleTime, gcTime patterns

## Initial Todo List
- [ ] Review existing TanStack Query setup and patterns
- [ ] Create new query keys for SWR-migrated queries
- [ ] Migrate critical path files (5 files)
- [ ] Migrate hooks (3 files)
- [ ] Migrate pages/routes (15 files)
- [ ] Migrate components (55+ files)
- [ ] Remove SWR from package.json
- [ ] Run type check and fix errors
- [ ] Run tests
- [ ] Manual testing of critical flows

## Context
- Created: 2024-12-22
- Branch: swr-to-tanstack-migration
- Base: master
- Worktree: /Users/corcoss/code/plane-wiki-collaborative-knowledge-base/.worktrees/swr-to-tanstack-migration
